df2 = df[-i,]
md = lm(NTS_MeaningfulExistence ~ femopost + study_t+ scanner_t , data = df2)
s = summary(md)
if (s$coefficients[2,4] < 0.3){
print(s$coefficients[2,4])
}
}
md = lm(NTS_Belongingness ~ femopost + study_t+ scanner_t +  age , data = df)
summary(md)
dvs = c("NTS_Belongingness","NTS_SelfEsteem",
"NTS_Control", "NTS_MeaningfulExistence","NTS_Mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("NTS_", "", DV))
plot_coef_df(coef_dv)
dvs = c("IRI_Perspective_Taking","IRI_Fantasy",
"IRI_Empathic_Concern","IRI_Personal_Distress", "IRI_mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("IRI_", "", DV))
coef_df
dvs = c("IRI_Perspective_Taking","IRI_Fantasy",
"IRI_Empathic_Concern","IRI_Personal_Distress", "IRI_mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("IRI_", "", DV)) %>%
filter(IV == "FB connectedness")
plot_coef_df(coef_dv)
colnames(df)
dvs = c("cacioppo_dacc_mask","ado_vs_mask",
"ado_lateralOFC_mask")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("NTS_", "", DV))
plot_coef_df(coef_dv)
dvs = c("cacioppo_dacc_mask","ado_vs_mask",
"ado_lateralOFC_mask")
coef_df = construct_coef_df_nts(dvs, df) %>%
mutate(DV = gsub("_roi_mask", "", DV))
construct_coef_df_nts = function(dvs,df){
mds1 = lapply(dvs, function(x) {
lm(substitute(i ~ NTS_Belongingness + study_t + scanner_t, list(i = as.name(x))), data = df)
})
sums1 = lapply(mds1, summary)
mds2 = lapply(dvs, function(x) {
lm(substitute(i ~ NTS_SelfEsteem + study_t + scanner_t, list(i = as.name(x))), data = df)
})
sums2 = lapply(mds2, summary)
mds3 = lapply(dvs, function(x) {
lm(substitute(i ~ NTS_Control + study_t + scanner_t, list(i = as.name(x))), data = df)
})
sums3 = lapply(mds3, summary)
mds4 = lapply(dvs, function(x) {
lm(substitute(i ~ NTS_MeaningfulExistence + study_t + scanner_t, list(i = as.name(x))), data = df)
})
sums4 = lapply(mds4, summary)
betas1 = c()
betas2 = c()
betas3 = c()
betas4 = c()
se1 = c()
se2 = c()
se3 = c()
se4 = c()
for (i in c(1:length(dvs))){
betas1 = c(betas1,sums1[[i]]$coefficients[2,1])
betas2 = c(betas2,sums2[[i]]$coefficients[2,1])
betas3 = c(betas3,sums3[[i]]$coefficients[2,1])
betas4 = c(betas4,sums4[[i]]$coefficients[2,1])
se1 = c(se1, sums1[[i]]$coefficients[2,2])
se2 = c(se2, sums2[[i]]$coefficients[2,2])
se3 = c(se3, sums3[[i]]$coefficients[2,2])
se4 = c(se4, sums4[[i]]$coefficients[2,2])
}
coef_df = data.frame("IV" = c(rep("Belongingness", length(dvs)),
rep("SelfEsteem", length(dvs)),
rep("Control", length(dvs)),
rep("MeaningfulExistence", length(dvs))),
"DV" = c(dvs,dvs,dvs,dvs),
"beta" = c(betas1, betas2,betas3,betas4),
"se" = c(se1, se2,se3,se4))
coef_df = coef_df
return(coef_df)
}
dvs = c("cacioppo_dacc_mask","ado_vs_mask",
"ado_lateralOFC_mask")
coef_df = construct_coef_df_nts(dvs, df) %>%
mutate(DV = gsub("_roi_mask", "", DV))
plot_coef_iri(coef_dv)
# dvs = c("cacioppo_dacc_mask")
#
# coef_df = construct_coef_df(dvs, df)
# plot_coef_df(coef_dv)
md = lm(cacioppo_dacc_mask ~ femopost + study_t + scanner_t + age, data = df)
md0 = lm(cacioppo_dacc_mask ~ study_t + scanner_t + age, data = df)
summ(md)
df$cacioppo_dacc_mask_resid = md0$residuals
ggscatter(df, "femopost", "cacioppo_dacc_mask_resid",
add = "reg.line",
conf.int = TRUE, # Add confidence interval
cor.coef = TRUE)
dvs = c("ado_lateralOFC_mask", "ado_vs_mask")
coef_df = construct_coef_df(dvs, df)
plot_coef_df(coef_dv)
dvs = c("rtpj_froi_mask","ltpj_froi_mask","subacc_ai_froi_mask",
"dmpfc_froi_mask","combined_froi_n59_mask")
coef_df = construct_coef_df(dvs, df)
plot_coef_df(coef_dv)
dvs = c("NTS_Belongingness","NTS_SelfEsteem",
"NTS_Control", "NTS_MeaningfulExistence","NTS_Mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("NTS_", "", DV))
plot_coef_df(coef_dv)
dvs = c("IRI_Perspective_Taking","IRI_Fantasy",
"IRI_Empathic_Concern","IRI_Personal_Distress", "IRI_mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("IRI_", "", DV)) %>%
filter(IV == "FB connectedness")
plot_coef_df(coef_dv)
dvs = c("IRI_Perspective_Taking","IRI_Fantasy",
"IRI_Empathic_Concern","IRI_Personal_Distress", "IRI_mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("IRI_", "", DV))
plot_coef_df(coef_dv)
dvs = c("IRI_Perspective_Taking","IRI_Fantasy",
"IRI_Empathic_Concern","IRI_Personal_Distress", "IRI_mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("IRI_", "", DV))  %>%
filter(IV == "Emotional FB use")
plot_coef_df(coef_dv)
ggscatter(df, "fconnected", "NTS_Mean")
ggscatter(df, "fconnected", "NTS_Mean", label = "TPS_ID", font.label = 10)
ggscatter(df, "fconnected", "NTS_Mean", label = "TPS_ID", repel = TRUE, font.label = 10)
df2 = df[-which(df$TPS_ID == "TPS1P0009"),]
md = lm(NTS_Mean ~ fconnected, data = df2)
summ(df2)
md = lm(NTS_Mean ~ fconnected, data = df2)
summ(md)
md = lm(NTS_Mean ~ fconnected + study_t, data = df2)
summ(md)
md = lm(NTS_Mean ~ fconnected + study_t + scanner_t, data = df2)
summ(md)
md = lm(NTS_Mean ~ fconnected + study_t +age, data = df2)
summ(md)
md = lm(NTS_Belongingness ~ fconnected + study_t +age, data = df2)
summ(md)
rm(list = ls())
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(plyr))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(kableExtra))
suppressPackageStartupMessages(library(ggpubr))
suppressPackageStartupMessages(library(pander))
suppressPackageStartupMessages(library(jtools))
source("~/Documents/GitHub/facebookUse/functions.R")
pd <- position_dodge(0.3) # move them .05 to the left and right
path =  "~/Box Sync/CurrentProjects_Penn/TPS12_BART/99_fomo/github/"
setwd(path)
## socialMedia data
socialMedia = read.csv(paste0(path, '0_facebook/tps2_facebook.csv'),na.strings=c("","NA"), stringsAsFactors = FALSE)[-1,]
socialMedia = socialMedia %>%
mutate(TPS_ID = as.factor(TPS_ID)) %>%
mutate_if(is.character,as.numeric) %>%
mutate(fhab = rowMeans(.[,10:19], na.rm = FALSE),
femo = rowMeans(.[c(8,9,20:39)], na.rm = FALSE),#20:39 ## include the two "feel connected" questions in Emotional FB use.
fconnected = rowMeans(.[c(8,9)], na.rm = FALSE),
femopost = rowMeans(.[c(20:39)], na.rm = FALSE),
TPS_ID = as.character(TPS_ID)) %>%
select(TPS_ID, fhab, femo,fconnected,femopost )
cyber = read.csv(paste0(path, '0_cyberball/cyberball_roi.csv'), stringsAsFactors = FALSE)
age = read.csv(paste0(path, '0_surveys/tps12_scanner_study_age.csv'), stringsAsFactors = FALSE) %>%
select(TPS_ID, age, study_t, scanner_t)
iri = read.csv(paste0(path, '0_surveys/iri_tps12.csv'), stringsAsFactors = FALSE)
iri = iri %>%
mutate(IRI_mean = rowMeans(select(iri, starts_with("IRI_")), na.rm = FALSE))
nts = read.csv(paste0(path, '0_surveys/nts.csv'), stringsAsFactors = FALSE)
df = cyber %>%
left_join(socialMedia, by = "TPS_ID") %>%
left_join(age, by = "TPS_ID") %>%
left_join(iri, by = "TPS_ID") %>%
left_join(nts, by = "TPS_ID")
# Remove NAs
df = df %>% drop_na(fhab,femo, NTS_Belongingness,
NTS_SelfEsteem, NTS_Control,
NTS_MeaningfulExistence, study_t, scanner_t,
IRI_Perspective_Taking, IRI_Fantasy,
IRI_Empathic_Concern, IRI_Personal_Distress,
fconnected)
df = df[-which(df$TPS_ID == "TPS1P0009"),]
ggscatter(df, "fconnected", "femopost",
add = "reg.line",
conf.int = TRUE, # Add confidence interval
cor.coef = TRUE)
m = corstar(df[,c("fhab","femo","fconnected","femopost")])
m[c(1,2),2] = ""
m[c(1:4),3] = ""
m[c(1:6),4] = ""
m[c(1:8),5] = ""
df_m = as.data.frame(m[,1:4])
rownames(df_m) = NULL
kable(df_m) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
df = df %>%
dplyr::rename(.,neurosynth_mask = ns_ment_mask,
ns_RSTS = ns_ment_clust1_mask,
ns_RTPJ = ns_ment_clust2_mask,
ns_DMPFC = ns_ment_clust3_mask,
ns_PCC = ns_ment_clust4_mask,
ns_VMPFC = ns_ment_clust5_mask,
ns_hippocampus = ns_ment_clust6_mask,
ns_LTPJ = ns_ment_clust7_mask,
ns_LSTS = ns_ment_clust8_mask)
dvs = c("neurosynth_mask","ns_RSTS", "ns_RTPJ",
"ns_DMPFC","ns_PCC" ,"ns_VMPFC",
"ns_hippocampus","ns_LTPJ","ns_LSTS")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("_mask", "", DV)) %>%
mutate(DV = gsub("ns_", "", DV))
plot_coef_df(coef_dv)
dvs = c("vmpfc_roi_mask","dmpfc_roi_mask","mmpfc_roi_mask", "precuneus_roi_mask",            "lTpj_roi_mask","rTpj_roi_mask" ,"rSts_roi_mask",
"saxe_combined_mask")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("_roi_mask", "", DV)) %>%
filter(IV == "Habitual FB use")
plot_coef_df(coef_dv)
dvs = c("IRI_Perspective_Taking","IRI_Fantasy",
"IRI_Empathic_Concern","IRI_Personal_Distress", "IRI_mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("IRI_", "", DV)) %>%
filter(IV == "Habitual FB use")
plot_coef_df(coef_dv)
dvs = c("neurosynth_mask","ns_RSTS", "ns_RTPJ",
"ns_DMPFC","ns_PCC" ,"ns_VMPFC",
"ns_hippocampus","ns_LTPJ","ns_LSTS")
coef_df = construct_coef_df_iri(dvs, df) %>%
mutate(DV = gsub("_roi_mask", "", DV)) %>%
filter(DV == "neurosynth_mask")
plot_coef_iri(coef_dv)
# md = lm(neurosynth_mask ~ IRI_Fantasy + age + study_t + scanner_t, data = df)
# summ(md)
dvs = c("vmpfc_roi_mask","dmpfc_roi_mask","mmpfc_roi_mask", "precuneus_roi_mask",            "lTpj_roi_mask","rTpj_roi_mask" ,"rSts_roi_mask",
"saxe_combined_mask")
coef_df = construct_coef_df_iri(dvs, df) %>%
mutate(DV = gsub("_roi_mask", "", DV)) %>%
filter(DV == "saxe_combined_mask")
plot_coef_iri(coef_dv)
# md = lm(saxe_combined_mask ~ IRI_Fantasy + age + study_t + scanner_t, data = df)
# summ(md)
# dvs = c("cacioppo_dacc_mask")
#
# coef_df = construct_coef_df(dvs, df)
# plot_coef_df(coef_dv)
md = lm(cacioppo_dacc_mask ~ fconnected + study_t + scanner_t + age, data = df)
md0 = lm(cacioppo_dacc_mask ~ study_t + scanner_t + age, data = df)
summ(md)
df$cacioppo_dacc_mask_resid = md0$residuals
ggscatter(df, "fconnected", "cacioppo_dacc_mask_resid",
add = "reg.line",
conf.int = TRUE, # Add confidence interval
cor.coef = TRUE)
dvs = c("ado_lateralOFC_mask", "ado_vs_mask")
coef_df = construct_coef_df(dvs, df)
plot_coef_df(coef_dv)
dvs = c("rtpj_froi_mask","ltpj_froi_mask","subacc_ai_froi_mask",
"dmpfc_froi_mask","combined_froi_n59_mask")
coef_df = construct_coef_df(dvs, df)
plot_coef_df(coef_dv)
dvs = c("NTS_Belongingness","NTS_SelfEsteem",
"NTS_Control", "NTS_MeaningfulExistence","NTS_Mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("NTS_", "", DV))
plot_coef_df(coef_dv)
---
## Update 1. Cacioppo ROI
ggscatter(df, "fconnected", "femopost",
add = "reg.line",
conf.int = TRUE, # Add confidence interval
cor.coef = TRUE) + xlab("FB connectedness") + ylab("FB emotional posting")
ggscatter(df, "fconnected", "femopost",
add = "reg.line",
conf.int = TRUE, # Add confidence interval
cor.coef = TRUE,
xlab = "FB connectedness", ylab = "FB emotional posting")
df = df %>%
dplyr::rename(.,neurosynth_mask = ns_ment_mask,
ns_RSTS = ns_ment_clust1_mask,
ns_RTPJ = ns_ment_clust2_mask,
ns_DMPFC = ns_ment_clust3_mask,
ns_PCC = ns_ment_clust4_mask,
ns_VMPFC = ns_ment_clust5_mask,
ns_hippocampus = ns_ment_clust6_mask,
ns_LTPJ = ns_ment_clust7_mask,
ns_LSTS = ns_ment_clust8_mask)
rm(list = ls())
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(plyr))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(kableExtra))
suppressPackageStartupMessages(library(ggpubr))
suppressPackageStartupMessages(library(pander))
suppressPackageStartupMessages(library(jtools))
source("~/Documents/GitHub/facebookUse/functions.R")
pd <- position_dodge(0.3) # move them .05 to the left and right
path =  "~/Box Sync/CurrentProjects_Penn/TPS12_BART/99_fomo/github/"
setwd(path)
## socialMedia data
socialMedia = read.csv(paste0(path, '0_facebook/tps2_facebook.csv'),na.strings=c("","NA"), stringsAsFactors = FALSE)[-1,]
socialMedia = socialMedia %>%
mutate(TPS_ID = as.factor(TPS_ID)) %>%
mutate_if(is.character,as.numeric) %>%
mutate(fhab = rowMeans(.[,10:19], na.rm = FALSE),
femo = rowMeans(.[c(8,9,20:39)], na.rm = FALSE),#20:39 ## include the two "feel connected" questions in Emotional FB use.
fconnected = rowMeans(.[c(8,9)], na.rm = FALSE),
femopost = rowMeans(.[c(20:39)], na.rm = FALSE),
TPS_ID = as.character(TPS_ID)) %>%
select(TPS_ID, fhab, femo,fconnected,femopost )
cyber = read.csv(paste0(path, '0_cyberball/cyberball_roi.csv'), stringsAsFactors = FALSE)
age = read.csv(paste0(path, '0_surveys/tps12_scanner_study_age.csv'), stringsAsFactors = FALSE) %>%
select(TPS_ID, age, study_t, scanner_t)
iri = read.csv(paste0(path, '0_surveys/iri_tps12.csv'), stringsAsFactors = FALSE)
iri = iri %>%
mutate(IRI_mean = rowMeans(select(iri, starts_with("IRI_")), na.rm = FALSE))
nts = read.csv(paste0(path, '0_surveys/nts.csv'), stringsAsFactors = FALSE)
df = cyber %>%
left_join(socialMedia, by = "TPS_ID") %>%
left_join(age, by = "TPS_ID") %>%
left_join(iri, by = "TPS_ID") %>%
left_join(nts, by = "TPS_ID")
# Remove NAs
df = df %>% drop_na(fhab,femo, NTS_Belongingness,
NTS_SelfEsteem, NTS_Control,
NTS_MeaningfulExistence, study_t, scanner_t,
IRI_Perspective_Taking, IRI_Fantasy,
IRI_Empathic_Concern, IRI_Personal_Distress,
fconnected)
ggscatter(df, "fconnected", "femopost",
add = "reg.line",
conf.int = TRUE, # Add confidence interval
cor.coef = TRUE,
xlab = "FB connectedness", ylab = "FB emotional posting")
m = corstar(df[,c("fhab","femo","fconnected","femopost")])
m[c(1,2),2] = ""
m[c(1:4),3] = ""
m[c(1:6),4] = ""
m[c(1:8),5] = ""
df_m = as.data.frame(m[,1:4])
rownames(df_m) = NULL
kable(df_m) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
df = df %>%
dplyr::rename(.,neurosynth_mask = ns_ment_mask,
ns_RSTS = ns_ment_clust1_mask,
ns_RTPJ = ns_ment_clust2_mask,
ns_DMPFC = ns_ment_clust3_mask,
ns_PCC = ns_ment_clust4_mask,
ns_VMPFC = ns_ment_clust5_mask,
ns_hippocampus = ns_ment_clust6_mask,
ns_LTPJ = ns_ment_clust7_mask,
ns_LSTS = ns_ment_clust8_mask)
dvs = c("neurosynth_mask","ns_RSTS", "ns_RTPJ",
"ns_DMPFC","ns_PCC" ,"ns_VMPFC",
"ns_hippocampus","ns_LTPJ","ns_LSTS")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("_mask", "", DV)) %>%
mutate(DV = gsub("ns_", "", DV)) %>%
filter(IV == "Habitual FB use")
plot_coef_df(coef_dv)
dvs = c("vmpfc_roi_mask","dmpfc_roi_mask","mmpfc_roi_mask", "precuneus_roi_mask",            "lTpj_roi_mask","rTpj_roi_mask" ,"rSts_roi_mask",
"saxe_combined_mask")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("_roi_mask", "", DV)) %>%
filter(IV == "Habitual FB use")
plot_coef_df(coef_dv)
dvs = c("ado_lateralOFC_mask", "ado_vs_mask")
coef_df = construct_coef_df(dvs, df)
coef_df
dvs = c("ado_lateralOFC_mask", "ado_vs_mask")
coef_df = construct_coef_df(dvs, df) %>%
filter(IV == "FB connectedness")
plot_coef_df(coef_dv)
dvs = c("rtpj_froi_mask","ltpj_froi_mask","subacc_ai_froi_mask",
"dmpfc_froi_mask","combined_froi_n59_mask")
coef_df = construct_coef_df(dvs, df) %>%
filter(IV == "FB connectedness")
plot_coef_df(coef_dv)
dvs = c("NTS_Belongingness","NTS_SelfEsteem",
"NTS_Control", "NTS_MeaningfulExistence","NTS_Mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("NTS_", "", DV))
plot_coef_df(coef_dv)
dvs = c("NTS_Belongingness","NTS_SelfEsteem",
"NTS_Control", "NTS_MeaningfulExistence","NTS_Mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("NTS_", "", DV)) %>%
filter(IV == "FB connectedness")
plot_coef_df(coef_dv)
dvs = c("IRI_Perspective_Taking","IRI_Fantasy",
"IRI_Empathic_Concern","IRI_Personal_Distress", "IRI_mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("IRI_", "", DV)) %>%
filter(IV == "FB connectedness")
plot_coef_df(coef_dv)
dvs = c("IRI_Perspective_Taking","IRI_Fantasy",
"IRI_Empathic_Concern","IRI_Personal_Distress", "IRI_mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("IRI_", "", DV)) %>%
filter(IV == "FB connectedness")
plot_coef_df(coef_dv)
md = lm(IRI_Empathic_Concern ~ fconnected + study_t + scanner_t, data = df)
summ(md)
dvs = c("IRI_Perspective_Taking","IRI_Fantasy",
"IRI_Empathic_Concern","IRI_Personal_Distress", "IRI_mean")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("IRI_", "", DV)) %>%
filter(IV == "FB connectedness")
plot_coef_df(coef_dv)
md = lm(IRI_Empathic_Concern ~ fconnected + study_t + scanner_t + age, data = df)
summ(md)
dvs = c("cacioppo_dacc_mask","ado_vs_mask",
"ado_lateralOFC_mask")
coef_df = construct_coef_df_nts(dvs, df) %>%
mutate(DV = gsub("_roi_mask", "", DV))
plot_coef_iri(coef_dv)
dvs = c("ado_lateralOFC_mask", "ado_vs_mask")
coef_df = construct_coef_df(dvs, df)
plot_coef_df(coef_dv)
rm(list = ls())
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(tidyverse))
suppressPackageStartupMessages(library(plyr))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(knitr))
suppressPackageStartupMessages(library(kableExtra))
suppressPackageStartupMessages(library(ggpubr))
suppressPackageStartupMessages(library(pander))
suppressPackageStartupMessages(library(jtools))
source("~/Documents/GitHub/facebookUse/functions.R")
pd <- position_dodge(0.3) # move them .05 to the left and right
path =  "~/Box Sync/CurrentProjects_Penn/TPS12_BART/99_fomo/github/"
setwd(path)
## socialMedia data
socialMedia = read.csv(paste0(path, '0_facebook/tps2_facebook.csv'),na.strings=c("","NA"), stringsAsFactors = FALSE)[-1,]
socialMedia = socialMedia %>%
mutate(TPS_ID = as.factor(TPS_ID)) %>%
mutate_if(is.character,as.numeric) %>%
mutate(fhab = rowMeans(.[,10:19], na.rm = FALSE),
femo = rowMeans(.[c(8,9,20:39)], na.rm = FALSE),#20:39 ## include the two "feel connected" questions in Emotional FB use.
fconnected = rowMeans(.[c(8,9)], na.rm = FALSE),
femopost = rowMeans(.[c(20:39)], na.rm = FALSE),
TPS_ID = as.character(TPS_ID)) %>%
select(TPS_ID, fhab, femo,fconnected,femopost )
cyber = read.csv(paste0(path, '0_cyberball/cyberball_roi.csv'), stringsAsFactors = FALSE)
age = read.csv(paste0(path, '0_surveys/tps12_scanner_study_age.csv'), stringsAsFactors = FALSE) %>%
select(TPS_ID, age, study_t, scanner_t)
iri = read.csv(paste0(path, '0_surveys/iri_tps12.csv'), stringsAsFactors = FALSE)
iri = iri %>%
mutate(IRI_mean = rowMeans(select(iri, starts_with("IRI_")), na.rm = FALSE))
nts = read.csv(paste0(path, '0_surveys/nts.csv'), stringsAsFactors = FALSE)
df = cyber %>%
left_join(socialMedia, by = "TPS_ID") %>%
left_join(age, by = "TPS_ID") %>%
left_join(iri, by = "TPS_ID") %>%
left_join(nts, by = "TPS_ID")
# Remove NAs
df = df %>% drop_na(fhab,femo, NTS_Belongingness,
NTS_SelfEsteem, NTS_Control,
NTS_MeaningfulExistence, study_t, scanner_t,
IRI_Perspective_Taking, IRI_Fantasy,
IRI_Empathic_Concern, IRI_Personal_Distress,
fconnected)
ggscatter(df, "fconnected", "femopost",
add = "reg.line",
conf.int = TRUE, # Add confidence interval
cor.coef = TRUE,
xlab = "FB connectedness", ylab = "FB emotional posting")
m = corstar(df[,c("fhab","femo","fconnected","femopost")])
m[c(1,2),2] = ""
m[c(1:4),3] = ""
m[c(1:6),4] = ""
m[c(1:8),5] = ""
df_m = as.data.frame(m[,1:4])
rownames(df_m) = NULL
kable(df_m) %>%
kable_styling(bootstrap_options = c("striped", "hover", "condensed", "responsive"))
df = df %>%
dplyr::rename(.,neurosynth_mask = ns_ment_mask,
ns_RSTS = ns_ment_clust1_mask,
ns_RTPJ = ns_ment_clust2_mask,
ns_DMPFC = ns_ment_clust3_mask,
ns_PCC = ns_ment_clust4_mask,
ns_VMPFC = ns_ment_clust5_mask,
ns_hippocampus = ns_ment_clust6_mask,
ns_LTPJ = ns_ment_clust7_mask,
ns_LSTS = ns_ment_clust8_mask)
dvs = c("neurosynth_mask","ns_RSTS", "ns_RTPJ",
"ns_DMPFC","ns_PCC" ,"ns_VMPFC",
"ns_hippocampus","ns_LTPJ","ns_LSTS")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("_mask", "", DV)) %>%
mutate(DV = gsub("ns_", "", DV)) %>%
filter(IV == "Habitual FB use")
plot_coef_df(coef_dv)
dvs = c("vmpfc_roi_mask","dmpfc_roi_mask","mmpfc_roi_mask", "precuneus_roi_mask",            "lTpj_roi_mask","rTpj_roi_mask" ,"rSts_roi_mask",
"saxe_combined_mask")
coef_df = construct_coef_df(dvs, df) %>%
mutate(DV = gsub("_roi_mask", "", DV)) %>%
filter(IV == "Habitual FB use")
plot_coef_df(coef_dv)
dvs = c("rtpj_froi_mask","ltpj_froi_mask","subacc_ai_froi_mask",
"dmpfc_froi_mask","combined_froi_n59_mask")
coef_df = construct_coef_df(dvs, df)
plot_coef_df(coef_dv)
